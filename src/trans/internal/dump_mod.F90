MODULE DUMP_MOD


INTERFACE DUMP
  MODULE PROCEDURE :: DUMPC0
  MODULE PROCEDURE :: DUMPL0
  MODULE PROCEDURE :: DUMPL1
  MODULE PROCEDURE :: DUMPI0
  MODULE PROCEDURE :: DUMPI1
END INTERFACE

PRIVATE :: DUMPL0, DUMPL1, DUMPI0, DUMPI1

CONTAINS

SUBROUTINE ODUMP (CDFILE, KLINE,CDNAME)

USE TPM_DISTR, ONLY : MYPROC

CHARACTER (LEN=*) :: CDFILE
INTEGER           :: KLINE
CHARACTER (LEN=*) :: CDNAME

CHARACTER (LEN=8) :: CLPROC
CHARACTER (LEN=64) :: CLFILE

LOGICAL :: LLEXIST

WRITE (CLPROC, '(I8.8)') MYPROC

CLFILE = TRIM (CDFILE)//'.'//CLPROC//".dat"

INQUIRE (FILE=TRIM (CLFILE), EXIST=LLEXIST)

IF (LLEXIST) THEN
  OPEN (77, FILE=TRIM (CLFILE), FORM='FORMATTED', STATUS='OLD', POSITION='APPEND', ACTION='WRITE')
ELSE
  OPEN (77, FILE=TRIM (CLFILE), FORM='FORMATTED', STATUS='NEW')
ENDIF

WRITE (77, *) CDNAME, '  ', CDFILE, '@', KLINE

END SUBROUTINE

SUBROUTINE CDUMP ()

CLOSE (77)

END SUBROUTINE

SUBROUTINE DUMPC0 (CDVAL)

CHARACTER (LEN=*) :: CDVAL

WRITE (77, *) CDVAL

END SUBROUTINE

SUBROUTINE DUMPL0 (LDVAL)

LOGICAL :: LDVAL

WRITE (77, *) LDVAL

END SUBROUTINE

SUBROUTINE DUMPL1 (LDVAL)

LOGICAL :: LDVAL (:)

INTEGER :: J

DO J = 1, SIZE (LDVAL)
 IF (LDVAL (J)) THEN
 WRITE (77, *) J, LDVAL (J)
 ENDIF
ENDDO

END SUBROUTINE

SUBROUTINE DUMPI0 (KVAL)

INTEGER :: KVAL 

INTEGER :: J

WRITE (77, *) KVAL 

END SUBROUTINE

SUBROUTINE DUMPI1 (KVAL)

INTEGER :: KVAL (:)

INTEGER :: J

DO J = 1, SIZE (KVAL)
 IF (KVAL (J) /= 0) THEN
 WRITE (77, *) J, KVAL (J)
 ENDIF
ENDDO

END SUBROUTINE

END MODULE
